23:26 2009-2-23

--SylixOS--

port FatFs need change some code as following:

1: change some setting ff.h & ffconf.h fix sylixos. (DIR -> FATDIR)

   ffconf.h do not need _FS_LOCK and FAST_SEEK option.

2: change code file(OEM code), do not report error.

3: change ff.c file:

   1. f_mount() add : fs->drive = LD2PD(vol); save drive.

   2. chang some function (use path to operat) : such as :

      f_open, f_opendir, f_unlink, f_mkdir, f_chmod, f_utime...

      add : dj.fs = NULL;        /* Clear file object */

   3. add some function, first param is FATFS.

      FRESULT f_open_ex (FATFS*, FIL*, uint64_t *uniq, const char*, BYTE);
      FRESULT f_opendir_ex (FATFS*, FATDIR*, uint64_t *uniq, const char*);
      FRESULT f_stat_ex (FATFS*, const char*, FILINFO*);
      FRESULT f_unlink_ex (FATFS*, const char*);
      FRESULT f_mkdir_ex (FATFS*, const char*);
      FRESULT f_chmod_ex (FATFS*, const char*, BYTE, BYTE);
      FRESULT f_utime_ex (FATFS*, const char*, const FILINFO*);
      FRESULT f_rename_ex (FATFS*, const char*, const char*);
      FRESULT f_syncfs (FATFS  *fs);
      
      f_open_ex and opendir_ex and get ino! 

   4: change f_mkfs() NFAT define (LW_CFG_...NFAT)

   5: check_fs() fix to ADS

   6: mem_cpy() mem_set() can use memcpy() memset() (FASTER)

   7: change chk_mounted()